<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø­Ø§Ø¯Ø«Ø© ÙÙˆØ±ÙŠØ© Ù…Ø¹ Ø§Ù„Ø®Ø¨ÙŠØ±</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap');
        body { 
            font-family: 'Tajawal', sans-serif; 
            background-color: #f8f9fa;
            overflow-x: hidden; 
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ (Sidebar) */
        .sidebar-nav {
            height: 100%;
            width: 0;
            position: fixed;
            z-index: 1050; 
            top: 0;
            right: 0;
            background-color: #00796b;
            overflow-x: hidden;
            transition: 0.5s;
            padding-top: 60px;
        }
        .sidebar-nav .closebtn {
            position: absolute;
            top: 0;
            left: 25px;
            font-size: 36px;
            margin-left: 50px;
            color: white;
            text-decoration: none;
        }
        .sidebar-nav a {
            padding: 8px 8px 8px 32px;
            text-decoration: none;
            font-size: 25px;
            color: #f1f1f1;
            display: block;
            transition: 0.3s;
        }
        .sidebar-nav a:hover {
            color: #00bcd4; 
            background-color: #005a4e;
        }

        /* ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ø´Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© */
        .chat-wrapper { transition: margin-right .5s; }
        .chat-container {
            height: 90vh; 
            display: flex;
            flex-direction: column;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        /* Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ù…Ø®ØµØµØ© Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
        .bg-lawyer { background-color: #e0f7fa; } 
        .bg-doctor { background-color: #e8f5e9; } 
        .bg-engineer { background-color: #fff3e0; } 
        .bg-marketer { background-color: #f3e5f5; } 

        .chat-header-card {
            background-color: white;
            border-bottom: 2px solid #00bcd4;
            padding: 15px;
        }
        .chat-messages {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
        }
        .chat-input {
            padding: 15px;
            background-color: #f8f9fa; /* Ø®Ù„ÙÙŠØ© Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
            border-top: 1px solid #ddd;
        }
        
        /* ** ØªØµÙ…ÙŠÙ… ÙÙ‚Ø§Ø¹Ø§Øª Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© (Ø§Ù„ÙˆØ§Ù‚Ø¹ÙŠØ© ÙˆØ§Ù„Ø¹ÙƒØ³) ** */
        .message-row {
            display: flex;
            margin-bottom: 15px;
            width: 100%;
        }
        .message {
            max-width: 75%;
            padding: 10px 15px;
            border-radius: 15px;
            position: relative;
            animation: fadeIn 0.3s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø®Ø¨ÙŠØ±/Ø§Ù„Ø¨ÙˆØª ØªØ¸Ù‡Ø± Ø¹Ù„Ù‰ Ø§Ù„ÙŠÙ…ÙŠÙ† */
        .message-bot-row {
            justify-content: flex-end; /* Ø¹ÙƒØ³ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù‡Ù†Ø§ */
        }
        .message-bot {
            background-color: #f0f0f0; /* Ù„ÙˆÙ† Ø§ÙØªØ­ Ù„Ù„Ø®Ø¨ÙŠØ± */
            color: #333;
            border-bottom-left-radius: 15px;
            border-bottom-right-radius: 5px;
        }

        /* Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¹Ù…ÙŠÙ„/Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØªØ¸Ù‡Ø± Ø¹Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø± */
        .message-client-row {
            justify-content: flex-start; /* Ø¹ÙƒØ³ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù‡Ù†Ø§ */
        }
        .message-client {
            background-color: #00bcd4; 
            color: white;
            border-bottom-right-radius: 15px;
            border-bottom-left-radius: 5px;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙˆÙ‚Øª */
        .message-time {
            position: absolute;
            font-size: 0.75em;
            bottom: 5px;
        }
        .message-client .message-time {
            color: rgba(255, 255, 255, 0.7); 
            right: 10px; /* Ø§Ù„ÙˆÙ‚Øª Ø¹Ù„Ù‰ Ø§Ù„ÙŠÙ…ÙŠÙ† Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¹Ù…ÙŠÙ„ */
        }
        .message-bot .message-time {
            color: rgba(51, 51, 51, 0.5); 
            left: 10px; /* Ø§Ù„ÙˆÙ‚Øª Ø¹Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø± Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¨ÙˆØª */
        }

        .message-client { padding-right: 55px; } /* Ù…Ø³Ø§ÙØ© Ù„Ù„ÙˆÙ‚Øª */
        .message-bot { padding-left: 55px; } /* Ù…Ø³Ø§ÙØ© Ù„Ù„ÙˆÙ‚Øª */

        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø© */
        .suggestion-btn {
            background-color: #e6f7ff;
            color: #00796b;
            border: 1px solid #00796b;
            margin-bottom: 8px;
            font-size: 0.95rem;
            transition: all 0.3s;
            border-radius: 20px;
        }
        .suggestion-btn:hover {
            background-color: #00796b;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .final-follow-up {
            font-style: italic;
            color: #0097a7;
            font-weight: bold;
            text-align: center;
            width: 100%;
        }
        /* Ø²Ø± Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª (Ø§Ù„Ù„Ù…Ø¨Ø©) */
        .toggle-suggestions-btn {
            background: none;
            border: none;
            color: #00bcd4;
            font-size: 1.5rem;
            margin-left: 10px;
            cursor: pointer;
            transition: color 0.2s;
        }
        .toggle-suggestions-btn:hover {
            color: #0097a7;
        }
        .toggle-suggestions-btn.active {
            color: #ffc107;
        }
        /* Ø²Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø£Ù†ÙŠÙ‚ */
        .btn-send-custom {
            background-color: #00bcd4; 
            border-color: #00bcd4;
            color: white;
            transition: all 0.3s;
        }
        .btn-send-custom:hover { 
            background-color: #0097a7; 
            transform: scale(1.05);
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø²Ø± Ø­Ø¬Ø² Ø§Ù„Ù…ÙˆØ¹Ø¯ */
        .btn-booking-custom {
            background-color: #ff9800;
            border-color: #ff9800;
            color: white;
            transition: all 0.3s;
        }
        .btn-booking-custom:hover {
            background-color: #f57c00;
            border-color: #f57c00;
            transform: scale(1.05);
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ù†Ø§ÙØ°Ø© Ø­Ø¬Ø² Ø§Ù„Ù…ÙˆØ¹Ø¯ */
        .booking-modal .modal-header {
            background-color: #00bcd4;
            color: white;
        }
        .booking-modal .modal-footer {
            justify-content: space-between;
        }
        
        /* ØªØ­Ø³ÙŠÙ† Ù…Ø¸Ù‡Ø± Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø§Ù„Ø¨ÙˆØª */
        .suggestions-container {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid #e0e0e0;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ */
        .welcome-message {
            text-align: center;
            color: #00796b;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        /* ØªÙ†Ø³ÙŠÙ‚ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¯ÙØ¹ */
        .payment-required-modal .modal-header {
            background-color: #ff9800;
            color: white;
        }
        .payment-required-modal .modal-body {
            text-align: center;
            padding: 30px;
        }
        .payment-icon {
            font-size: 4rem;
            color: #ff9800;
            margin-bottom: 20px;
        }
        .payment-details {
            background-color: #fff3e0;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
    </style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</head>
<body>
    
    <div id="mySidebar" class="sidebar-nav">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
        
        <a href="profile.html"><i class="bi bi-person-circle me-2"></i> Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</a>
        <a href="my-appointments.html"><i class="bi bi-calendar-check me-2"></i> Ù…ÙˆØ§Ø¹ÙŠØ¯ÙŠ</a>
        <a href="chat-dynamic.html"><i class="bi bi-chat-dots me-2"></i> Ù…Ø­Ø§Ø¯Ø«Ø§ØªÙŠ Ø§Ù„Ø£Ø®Ø±Ù‰</a>
        <a href="#"><i class="bi bi-gear me-2"></i> Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</a>
        <hr class="text-white mx-3">
        <a href="welcome.html" class="text-danger"><i class="bi bi-box-arrow-right me-2"></i> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</a>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø­Ø¬Ø² Ø§Ù„Ù…ÙˆØ¹Ø¯ -->
    <div class="modal fade booking-modal" id="bookingModal" tabindex="-1" aria-labelledby="bookingModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="bookingModalLabel">Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯ Ù…Ø¹ Ø§Ù„Ø®Ø¨ÙŠØ±</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="bookingForm">
                        <div class="mb-3">
                            <label for="bookingDate" class="form-label">Ø§Ø®ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
                            <input type="date" class="form-control" id="bookingDate" required>
                        </div>
                        <div class="mb-3">
                            <label for="bookingTime" class="form-label">Ø§Ø®ØªØ± Ø§Ù„ÙˆÙ‚Øª</label>
                            <select class="form-select" id="bookingTime" required>
                                <option value="" selected disabled>Ø§Ø®ØªØ± Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨</option>
                                <option value="09:00">09:00 ØµØ¨Ø§Ø­Ø§Ù‹</option>
                                <option value="10:00">10:00 ØµØ¨Ø§Ø­Ø§Ù‹</option>
                                <option value="11:00">11:00 ØµØ¨Ø§Ø­Ø§Ù‹</option>
                                <option value="12:00">12:00 Ø¸Ù‡Ø±Ø§Ù‹</option>
                                <option value="13:00">01:00 Ù…Ø³Ø§Ø¡Ù‹</option>
                                <option value="14:00">02:00 Ù…Ø³Ø§Ø¡Ù‹</option>
                                <option value="15:00">03:00 Ù…Ø³Ø§Ø¡Ù‹</option>
                                <option value="16:00">04:00 Ù…Ø³Ø§Ø¡Ù‹</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="sessionType" class="form-label">Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù„Ø³Ø©</label>
                            <select class="form-select" id="sessionType" required>
                                <option value="video" selected>Ù…ÙƒØ§Ù„Ù…Ø© ÙÙŠØ¯ÙŠÙˆ</option>
                                <option value="audio">Ù…ÙƒØ§Ù„Ù…Ø© ØµÙˆØªÙŠØ©</option>
                                <option value="chat">Ù…Ø­Ø§Ø¯Ø«Ø© Ù†ØµÙŠØ©</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="notes" class="form-label">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                            <textarea class="form-control" id="notes" rows="3" placeholder="Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© ØªÙˆØ¯ Ø¥Ø¶Ø§ÙØªÙ‡Ø§..."></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
                    <button type="button" class="btn btn-booking-custom" id="confirmBooking">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ -->
    <div class="modal fade payment-required-modal" id="paymentRequiredModal" tabindex="-1" aria-labelledby="paymentRequiredModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="paymentRequiredModalLabel">Ø¥ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¯ÙØ¹</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="payment-icon">
                        <i class="bi bi-credit-card"></i>
                    </div>
                    <h4 class="mb-3">Ø­Ø¬Ø²Ùƒ ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø¯ÙØ¹</h4>
                    <p class="mb-4">Ù„Ø¥ÙƒÙ…Ø§Ù„ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø­Ø¬Ø²ØŒ ÙŠØ±Ø¬Ù‰ Ø¥ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¯ÙØ¹ Ù„ØªØ£Ù…ÙŠÙ† Ù…ÙˆØ¹Ø¯Ùƒ Ù…Ø¹ Ø§Ù„Ø®Ø¨ÙŠØ±.</p>
                    
                    <div class="payment-details">
                        <div class="d-flex justify-content-between mb-2">
                            <span>Ø§Ù„Ø®Ø¨ÙŠØ±:</span>
                            <strong id="paymentExpertName">Ø§Ù„Ù…Ø­Ø§Ù…ÙŠ Ø³Ø¹ÙˆØ¯ Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ</strong>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª:</span>
                            <strong id="paymentDateTime">Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡, 8 Ø£ÙƒØªÙˆØ¨Ø± - 01:30 Ù…</strong>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù„Ø³Ø©:</span>
                            <strong id="paymentSessionType">Ù…ÙƒØ§Ù„Ù…Ø© ÙÙŠØ¯ÙŠÙˆ</strong>
                        </div>
                        <div class="d-flex justify-content-between">
                            <span>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªØ­Ù‚:</span>
                            <strong id="paymentAmount">180 Ø±.Ø³</strong>
                        </div>
                    </div>
                    
                    <div class="alert alert-info mt-4">
                        <i class="bi bi-info-circle me-2"></i>
                        <strong>Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> Ø³ÙŠØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­Ø¬Ø² ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¯ÙØ¹ Ø®Ù„Ø§Ù„ 15 Ø¯Ù‚ÙŠÙ‚Ø©.
                    </div>
                </div>
                <div class="modal-footer justify-content-center">
                    <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
                    <button type="button" class="btn btn-success btn-lg" id="proceedToPayment">
                        <i class="bi bi-credit-card me-2"></i> Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø¯ÙØ¹
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="container pt-4 chat-wrapper" id="chatWrapper">
        <div class="chat-container">
            
            <div class="chat-header-card" id="expertInfoCard">
                </div>

            <div class="chat-messages" id="chatMessages">
                </div>

            <div class="chat-input">
                <div class="suggestions-container" id="botSuggestions" style="display: none;">
                    <h6 class="welcome-message">Ø§Ø®ØªØ± Ø£Ø­Ø¯ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©:</h6>
                    <div class="d-grid gap-2" id="suggestionsList">
                    </div>
                </div>
                <form id="chatForm" class="d-flex align-items-center">
                    <button type="button" id="toggleSuggestions" class="toggle-suggestions-btn p-0">
                        <i class="bi bi-lightbulb"></i>
                    </button>
                    <input type="text" id="messageInput" class="form-control form-control-lg me-2" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ..." required>
                    
                    <button type="submit" class="btn btn-send-custom btn-lg p-2 px-3">
                        <i class="bi bi-send-fill fs-5"></i>
                    </button>
                </form>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // ** Ù…Ù†Ø·Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© (Sidebar) **
        function openNav() {
            document.getElementById("mySidebar").style.width = "250px";
            document.getElementById("chatWrapper").style.marginRight = "250px";
        }
        function closeNav() {
            document.getElementById("mySidebar").style.width = "0";
            document.getElementById("chatWrapper").style.marginRight = "0";
        }
        
        $(document).ready(function() {
            const $chatMessages = $('#chatMessages');
            const $expertInfoCard = $('#expertInfoCard');
            const $botSuggestions = $('#botSuggestions');
            const $suggestionsList = $('#suggestionsList');
            const $toggleSuggestions = $('#toggleSuggestions');
            const bookingModal = new bootstrap.Modal(document.getElementById('bookingModal'));
            const paymentRequiredModal = new bootstrap.Modal(document.getElementById('paymentRequiredModal'));
            
            // Ù‚Ø±Ø§Ø¡Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø¨ÙŠØ± Ø§Ù„Ù…Ø®Ø²Ù†Ø© (Ø£Ùˆ Ø¨ÙŠØ§Ù†Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±)
            let expertData;
            try {
                 expertData = JSON.parse(localStorage.getItem('currentExpert'));
            } catch (e) {
                expertData = { id: 'expert1', name: 'Ø§Ù„Ù…Ø­Ø§Ù…ÙŠ Ø³Ø¹ÙˆØ¯ Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ', profession: 'Ù…Ø­Ø§Ù…ÙŠ Ø´Ø±ÙƒØ§Øª', available: 'true' };
            }

            // ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø¨ÙˆØª ÙˆØ§Ù„Ø±Ø¯ÙˆØ¯ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© (ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ù…ØªÙ†ÙˆØ¹Ø©)
            const botResponses = {
                intro: `Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø®Ø¯Ù…Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„ÙÙˆØ±ÙŠØ©! ğŸ‘‹ <br>ÙŠØ³Ø¹Ø¯Ù†Ø§ ØªÙˆØ§ØµÙ„Ùƒ Ù…Ø¹Ù†Ø§. ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø®ØªÙŠØ§Ø± Ø£Ø­Ø¯ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø£Ø¯Ù†Ø§Ù‡ Ø£Ùˆ ÙƒØªØ§Ø¨Ø© Ø§Ø³ØªÙØ³Ø§Ø±Ùƒ Ù…Ø¨Ø§Ø´Ø±Ø©.`,
                followUp: `Ù‡Ù„ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ù…Ø³Ø§Ø¹Ø¯Ø© Ø¥Ø¶Ø§ÙÙŠØ©ØŸ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø®ØªÙŠØ§Ø± Ø£Ø­Ø¯ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø£Ùˆ ÙƒØªØ§Ø¨Ø© Ø³Ø¤Ø§Ù„Ùƒ Ù…Ø¨Ø§Ø´Ø±Ø©.`,
                bookingConfirmed: `ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯Ùƒ Ø¨Ù†Ø¬Ø§Ø­! ğŸ“… <br>Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¯ÙØ¹ Ù„ØªØ£Ù…ÙŠÙ† Ø§Ù„Ù…ÙˆØ¹Ø¯.`,
                paymentRequired: `ÙŠØ±Ø¬Ù‰ Ø¥ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¯ÙØ¹ Ù„ØªØ£ÙƒÙŠØ¯ Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯Ùƒ.`,
                suggestions: [
                    { id: 1, text: 'ÙƒÙŠÙ Ø£Ø­Ø¬Ø² Ø¬Ù„Ø³Ø© Ø§Ø³ØªØ´Ø§Ø±ÙŠØ©ØŸ', reply: 'Ù„Ù„Ø­Ø¬Ø²ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± "Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯" ÙÙŠ Ø§Ù„Ø£Ø¹Ù„Ù‰ ÙˆØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ§Ø³Ø¨. ÙŠØªÙ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø² Ø¨Ø¹Ø¯ Ø§Ù„Ø¯ÙØ¹.' },
                    { id: 2, text: 'Ù…Ø§ Ù‡ÙŠ ØªÙƒÙ„ÙØ© Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ø§Ø³ØªØ´Ø§Ø±ÙŠØ©ØŸ', reply: 'Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø¬Ù„Ø³Ø§Øª ØªØ¨Ø¯Ø£ Ù…Ù† 150 Ø±ÙŠØ§Ù„ Ù„Ù…Ø¯Ø© 15 Ø¯Ù‚ÙŠÙ‚Ø©. ØªØ®ØªÙ„Ù Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø­Ø³Ø¨ Ù…Ø¯Ø© ÙˆÙ†ÙˆØ¹ Ø§Ù„Ø§Ø³ØªØ´Ø§Ø±Ø©.' },
                    { id: 3, text: 'Ù‡Ù„ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø¥Ø¹Ø§Ø¯Ø© Ø¬Ø¯ÙˆÙ„Ø© Ù…ÙˆØ¹Ø¯ÙŠØŸ', reply: 'Ù†Ø¹Ù…ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¹Ø§Ø¯Ø© Ø¬Ø¯ÙˆÙ„Ø© Ù…ÙˆØ¹Ø¯Ùƒ Ù…Ù† Ø®Ù„Ø§Ù„ ØµÙØ­Ø© "Ù…ÙˆØ§Ø¹ÙŠØ¯ÙŠ" ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©ØŒ Ø¨Ø´Ø±Ø· Ø£Ù† ÙŠÙƒÙˆÙ† Ù‚Ø¨Ù„ 24 Ø³Ø§Ø¹Ø© Ù…Ù† Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø£ØµÙ„ÙŠ.' },
                    { id: 4, text: 'Ù…Ø§ Ù‡ÙŠ Ø·Ø±Ù‚ Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ù…ØªØ§Ø­Ø©ØŸ', reply: 'Ù†Ù‚Ø¨Ù„ Ø§Ù„Ø¯ÙØ¹ Ø¨Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø§Ø¦ØªÙ…Ø§Ù† ÙˆØ§Ù„Ù…Ø¯Ù‰ ÙˆØ­ÙˆØ§Ù„Ø§Øª Ø¨Ù†ÙƒÙŠØ© ÙˆØªØ­ÙˆÙŠÙ„Ø§Øª Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©.' },
                    { id: 5, text: 'Ù‡Ù„ Ø§Ù„Ø¬Ù„Ø³Ø§Øª Ø³Ø±ÙŠØ© ÙˆØ¢Ù…Ù†Ø©ØŸ', reply: 'Ù†Ø¹Ù…ØŒ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ù„Ø³Ø§Øª Ø³Ø±ÙŠØ© ÙˆÙ…Ø´ÙØ±Ø©. Ù†Ø­Ù† Ù†Ù„ØªØ²Ù… Ø¨Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø®ØµÙˆØµÙŠØ© ÙˆØ§Ù„Ø£Ù…Ø§Ù† Ù„Ø­Ù…Ø§ÙŠØ© Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ.' },
                    { id: 6, text: 'ÙƒÙŠÙ Ø£Ø³ØªØ¹Ø¯ Ù„Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ØŸ', reply: 'Ù†Ù†ØµØ­ Ø¨ØªØ¬Ù‡ÙŠØ² Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆØ§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ù…ØªØ¹Ù„Ù‚Ø© Ø¨Ø§Ø³ØªÙØ³Ø§Ø±Ùƒ Ù…Ø³Ø¨Ù‚Ø§Ù‹ Ù„ØªØ­Ù‚ÙŠÙ‚ Ø£Ù‚ØµÙ‰ Ø§Ø³ØªÙØ§Ø¯Ø© Ù…Ù† Ø§Ù„Ø¬Ù„Ø³Ø©.' },
                    { id: 7, text: 'Ù…Ø§ Ù‡ÙŠ Ù…Ø¯Ø© Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ø§Ø¹ØªÙŠØ§Ø¯ÙŠØ©ØŸ', reply: 'Ù…Ø¯Ø© Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠØ© Ù‡ÙŠ 15 Ø¯Ù‚ÙŠÙ‚Ø©ØŒ Ù…Ø¹ Ø¥Ù…ÙƒØ§Ù†ÙŠØ© ØªÙ…Ø¯ÙŠØ¯Ù‡Ø§ Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ø¬Ø©.' },
                    { id: 8, text: 'Ù‡Ù„ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø®Ø¨ÙŠØ± Ø¨Ø¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¬Ù„Ø³Ø©ØŸ', reply: 'Ù†Ø¹Ù…ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªÙˆØ§ØµÙ„ Ø¹Ø¨Ø± Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø£Ùˆ Ø­Ø¬Ø² Ø¬Ù„Ø³Ø© Ù…ØªØ§Ø¨Ø¹Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³ØªØ´Ø§Ø±Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©.' },
                    { id: 9, text: 'Ù…Ø§ Ù‡ÙŠ Ù…Ø¬Ø§Ù„Ø§Øª ØªØ®ØµØµ Ø§Ù„Ø®Ø¨ÙŠØ±ØŸ', reply: 'Ø§Ù„Ø®Ø¨ÙŠØ± Ù…ØªØ®ØµØµ ÙÙŠ Ø§Ù„Ù‚Ø¶Ø§ÙŠØ§ Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ© ÙˆØ§Ù„Ø¹Ù‚ÙˆØ¯ ÙˆØ§Ù„Ù…Ù†Ø§Ø²Ø¹Ø§Øª Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© Ø§Ù„Ù…ØªØ¹Ù„Ù‚Ø© Ø¨Ø§Ù„Ø´Ø±ÙƒØ§Øª.' },
                    { id: 10, text: 'ÙƒÙŠÙ Ø£Ø­ØµÙ„ Ø¹Ù„Ù‰ ÙØ§ØªÙˆØ±Ø© Ù„Ù„Ø¬Ù„Ø³Ø©ØŸ', reply: 'Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙØ§ØªÙˆØ±Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¥Ù„Ù‰ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø¨Ø¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¬Ù„Ø³Ø©.' }
                ]
            };
            
            // Ø¯Ø§Ù„Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¨ØªÙ†Ø³ÙŠÙ‚ ÙˆØ§Ù‚Ø¹ÙŠ (Ù…Ø«Ø§Ù„: 10:45 Øµ)
            function getCurrentTime() {
                const now = new Date();
                const hours = now.getHours();
                const minutes = now.getMinutes().toString().padStart(2, '0');
                const ampm = hours >= 12 ? 'Ù…' : 'Øµ';
                const formattedHours = hours % 12 || 12;
                return `${formattedHours}:${minutes} ${ampm}`;
            }

            // ** Ø¯Ø§Ù„Ø© Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ù…Ø­Ø§Ø¯Ø«Ø© (Ù…Ø­Ø¯Ø«Ø© Ù„Ù„ÙˆØ§Ù‚Ø¹ÙŠØ©) **
            function addMessage(text, type, isFollowUp = false) {
                const messageClass = `message-${type}`;
                const rowClass = `message-${type}-row`;
                const followUpClass = isFollowUp ? 'final-follow-up' : '';
                const messageTime = getCurrentTime();

                const messageHtml = `
                    <div class="message-row ${rowClass}">
                        <div class="message ${messageClass} ${followUpClass}">
                            <p class="mb-0">${text}</p>
                            ${!isFollowUp ? `<span class="message-time">${messageTime}</span>` : ''}
                        </div>
                    </div>
                `;
                $chatMessages.append(messageHtml);
                $chatMessages.scrollTop($chatMessages[0].scrollHeight);
            }

            // ** ÙˆØ¸ÙŠÙØ© Ø¥Ø¹Ø¯Ø§Ø¯ Ø´Ø§Ø´Ø© Ø§Ù„Ø´Ø§Øª **
            function initializeChat() {
                if (expertData) {
                    // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø®Ù„ÙÙŠØ©
                    let backgroundClass = 'bg-lawyer';
                    const professionType = expertData.profession.split(' ')[0];
                    switch(professionType) {
                        case 'Ø·Ø¨ÙŠØ¨': backgroundClass = 'bg-doctor'; break;
                        case 'Ù…Ù‡Ù†Ø¯Ø³': backgroundClass = 'bg-engineer'; break;
                        case 'Ù…Ø³ÙˆÙ‚': backgroundClass = 'bg-marketer'; break;
                    }
                    $chatMessages.addClass(backgroundClass);
                    
                    // Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø¨ÙŠØ± ÙÙŠ Ø§Ù„ÙƒØ§Ø±Ø¯ Ø§Ù„Ø¹Ù„ÙˆÙŠ
                    const statusText = expertData.available === 'true' ? 
                                       `<span class="text-success fw-bold">Ù…ØªØ§Ø­ Ù„Ù„Ø­Ø¬Ø²</span>` : 
                                       `<span class="text-danger fw-bold">ØºÙŠØ± Ù…ØªØ§Ø­</span>`;
                                
                    $expertInfoCard.html(`
                        <div class="d-flex align-items-center">
                            <a href="client-browse.html.html" class="text-dark me-3 text-decoration-none">
                                <i class="bi bi-arrow-right fs-4"></i>
                            </a>
                            <img src="img/16.jpg" class="rounded-circle me-3" style="width: 50px; height: 50px;">
                            <div>
                                <h5 class="mb-0">${expertData.name}</h5>
                                <small class="text-muted">${expertData.profession} - ${statusText}</small>
                            </div>
                            <button class="btn btn-sm btn-booking-custom mx-2" id="openBookingModal"><i class="bi bi-calendar-check me-1"></i> Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯</button>
                            <button class="btn btn-outline-secondary ms-auto" onclick="openNav()"><i class="bi bi-list"></i></button>
                        </div>
                    `);
                    
                    // Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø¨Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¨ÙˆØª Ø§Ù„ØªØ±Ø­ÙŠØ¨ÙŠØ©
                    addMessage(botResponses.intro, 'bot');
                    
                    // Ø¹Ø±Ø¶ Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø§Ù„Ø¨ÙˆØª ÙƒØ£Ø²Ø±Ø§Ø± (Ù…Ø®ÙÙŠØ© Ù…Ø¨Ø¯Ø¦ÙŠØ§Ù‹)
                    botResponses.suggestions.forEach(q => {
                        $suggestionsList.append(`<button class="btn suggestion-btn" data-id="${q.id}">${q.text}</button>`);
                    });
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ø§Ù„Ù†Ù‚Ø± Ù„Ø²Ø± Ø­Ø¬Ø² Ø§Ù„Ù…ÙˆØ¹Ø¯
                    $('#openBookingModal').on('click', function() {
                        // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„ØªØ§Ø±ÙŠØ® (Ø§Ù„ÙŠÙˆÙ…)
                        const today = new Date().toISOString().split('T')[0];
                        $('#bookingDate').attr('min', today);
                        
                        // ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø­Ø¬Ø² Ø§Ù„Ù…ÙˆØ¹Ø¯
                        bookingModal.show();
                    });
                    
                    // ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²
                    $('#confirmBooking').on('click', function() {
                        const bookingDate = $('#bookingDate').val();
                        const bookingTime = $('#bookingTime').val();
                        const sessionType = $('#sessionType').val();
                        const notes = $('#notes').val();
                        
                        if (bookingDate && bookingTime && sessionType) {
                            // Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø² ÙÙŠ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
                            addMessage(`Ù„Ù‚Ø¯ Ù‚Ù…Øª Ø¨Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯ Ø¨ØªØ§Ø±ÙŠØ® ${formatDate(bookingDate)} Ø§Ù„Ø³Ø§Ø¹Ø© ${bookingTime} (${sessionType === 'video' ? 'Ù…ÙƒØ§Ù„Ù…Ø© ÙÙŠØ¯ÙŠÙˆ' : sessionType === 'audio' ? 'Ù…ÙƒØ§Ù„Ù…Ø© ØµÙˆØªÙŠØ©' : 'Ù…Ø­Ø§Ø¯Ø«Ø© Ù†ØµÙŠØ©'})`, 'client');
                            
                            // Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø­Ø¬Ø²
                            bookingModal.hide();
                            
                            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                            $('#bookingForm')[0].reset();
                            
                            // Ø±Ø¯ Ø§Ù„Ø¨ÙˆØª Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø¬Ø²
                            setTimeout(() => {
                                addMessage(botResponses.bookingConfirmed, 'bot');
                            }, 1000);
                            
                            // Ø¥Ø¸Ù‡Ø§Ø± Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ø¨Ø¹Ø¯ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²
                            setTimeout(() => {
                                // ØªØ¹Ø¨Ø¦Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙØ¹ ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
                                $('#paymentExpertName').text(expertData.name);
                                $('#paymentDateTime').text(`${formatDate(bookingDate)} - ${bookingTime}`);
                                $('#paymentSessionType').text(sessionType === 'video' ? 'Ù…ÙƒØ§Ù„Ù…Ø© ÙÙŠØ¯ÙŠÙˆ' : sessionType === 'audio' ? 'Ù…ÙƒØ§Ù„Ù…Ø© ØµÙˆØªÙŠØ©' : 'Ù…Ø­Ø§Ø¯Ø«Ø© Ù†ØµÙŠØ©');
                                $('#paymentAmount').text('180 Ø±.Ø³');
                                
                                // Ø¥Ø¸Ù‡Ø§Ø± Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
                                paymentRequiredModal.show();
                            }, 2500);
                        } else {
                            alert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©');
                        }
                    });
                }
            }
            
            // ** Ø¯Ø§Ù„Ø© Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø¥Ù„Ù‰ ØªÙ†Ø³ÙŠÙ‚ Ø¹Ø±Ø¨ÙŠ **
            function formatDate(dateString) {
                const date = new Date(dateString);
                const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                return date.toLocaleDateString('ar-SA', options);
            }
            
            // ** Ù…Ù†Ø·Ù‚ Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø¨Ø²Ø± Ø§Ù„Ù„Ù…Ø¨Ø© **
            $toggleSuggestions.on('click', function() {
                $botSuggestions.slideToggle(300);
                $(this).toggleClass('active');
                
                // ØªØºÙŠÙŠØ± Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù„Ù…Ø¨Ø©
                const $icon = $(this).find('i');
                if ($botSuggestions.is(':visible')) {
                    $icon.removeClass('bi-lightbulb').addClass('bi-lightbulb-fill');
                } else {
                    $icon.removeClass('bi-lightbulb-fill').addClass('bi-lightbulb');
                }
            });

            // ** Ù…Ù†Ø·Ù‚ Ø§Ù„Ø±Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª **
            $suggestionsList.on('click', '.suggestion-btn', function() {
                const qId = $(this).data('id');
                const selectedQ = botResponses.suggestions.find(q => q.id === qId);

                if (selectedQ) {
                    // 1. Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„ (Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­ Ø§Ù„Ø°ÙŠ Ø§Ø®ØªØ§Ø±Ù‡)
                    addMessage(selectedQ.text, 'client');
                    
                    // 2. Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±
                    $botSuggestions.slideUp(300);
                    $toggleSuggestions.removeClass('active');
                    $toggleSuggestions.find('i').removeClass('bi-lightbulb-fill').addClass('bi-lightbulb');
                    
                    // 3. Ø±Ø³Ø§Ù„Ø© Ø±Ø¯ Ø§Ù„Ø¨ÙˆØª (Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„Ù…Ø®ØµØµØ©)
                    setTimeout(() => {
                        addMessage(selectedQ.reply, 'bot');
                    }, 500);
                    
                    // 4. Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©
                    setTimeout(() => {
                        addMessage(botResponses.followUp, 'bot', true);
                    }, 1500);
                }
            });

            // ** Ù…Ù†Ø·Ù‚ Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„ (Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ© Ø¹Ø§Ø¯ÙŠØ©) **
            $('#chatForm').on('submit', function(e) {
                e.preventDefault();
                const messageText = $('#messageInput').val().trim();

                if (messageText !== '') {
                    // Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„
                    addMessage(messageText, 'client');
                    $('#messageInput').val(''); 
                    
                    // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…Ø®ÙÙŠØ©
                    $botSuggestions.slideUp(300); 
                    $toggleSuggestions.removeClass('active');
                    $toggleSuggestions.find('i').removeClass('bi-lightbulb-fill').addClass('bi-lightbulb');

                    // Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© (Ø±Ø¯ Ø§Ù„Ø¨ÙˆØª Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø³Ø¤Ø§Ù„)
                    setTimeout(() => {
                         addMessage(botResponses.followUp, 'bot', true);
                    }, 1000);
                }
            });
            
            // ** Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„Ø¯ÙØ¹ **
            $('#proceedToPayment').on('click', function() {
    // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„Ø¯ÙØ¹ (booking.html)
    window.location.href = 'booking.html';
    
    // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
    paymentRequiredModal.hide();
});
            
            // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ø¹Ù†Ø¯ Ø§Ù„ÙƒØªØ§Ø¨Ø© ÙÙŠ Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
            $('#messageInput').on('focus', function() {
                $(this).css('box-shadow', '0 0 0 0.2rem rgba(0, 188, 212, 0.25)');
            }).on('blur', function() {
                $(this).css('box-shadow', 'none');
            });
            
            initializeChat();
        });
    </script>
</body>
</html>